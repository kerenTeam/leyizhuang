<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="css/mui.min.css" rel="stylesheet" />

		<style>
			ul {
				font-size: 14px;
				color: #8f8f94;
			}
			.mui-btn {
				padding: 10px;
			}
			.mui-placeholder span{color: #333333;}
			.flexw,.flexws{display: flex;align-items: center;justify-content: space-around;text-align: center;margin-top: 15px;font-size:14px}
			.flexw img,.flexws img{
				display: block;
				width: 30px;
				height: 30px;
				margin:auto;
				 
			}
			.ltac .imgb{ 
				margin:5px auto;
				width: 60px;
				height:60px;
				padding:15px;
				border-radius:50%;
				 
			}
			.mui-table-view:after,.mui-table-view:before,.mui-table-view-cell:after,.mui-table-view-cell:before{
				height:0!important;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="padding-right: 15px;">
			<h1 class="mui-title">首页</h1>
			<button id='setting' class=" mui-pull-right mui-btn-link">设置</button>
		</header>
		<div class="mui-content">
			<div style="position: relative;">
				<div class="mui-slider"> 
				  <div class="mui-slider-group mui-slider-loop">
				    <!--支持循环，需要重复图片节点-->
				    <div class="mui-slider-item mui-slider-item-duplicate"><a href="#"><img src="https://b-ssl.duitang.com/uploads/item/201610/11/20161011213437_HeKXZ.thumb.700_0.jpeg" /></a></div>
				    <div class="mui-slider-item"><a href="#"><img src="https://b-ssl.duitang.com/uploads/item/201610/11/20161011213437_HeKXZ.thumb.700_0.jpeg" /></a></div>
				    <div class="mui-slider-item"><a href="#"><img src="https://b-ssl.duitang.com/uploads/item/201610/11/20161011213437_HeKXZ.thumb.700_0.jpeg" /></a></div>
				    <div class="mui-slider-item"><a href="#"><img src="https://b-ssl.duitang.com/uploads/item/201610/11/20161011213437_HeKXZ.thumb.700_0.jpeg" /></a></div>
				    <div class="mui-slider-item"><a href="#"><img src="https://b-ssl.duitang.com/uploads/item/201610/11/20161011213437_HeKXZ.thumb.700_0.jpeg" /></a></div>
				    <!--支持循环，需要重复图片节点-->
				    <div class="mui-slider-item mui-slider-item-duplicate"><a href="#"><img src="https://b-ssl.duitang.com/uploads/item/201610/11/20161011213437_HeKXZ.thumb.700_0.jpeg" /></a></div>
				  </div>
				</div>
				<div class="mui-input-row mui-search" style="z-index:1;position: absolute;top: 10px;left: 20px;right: 20px;">
				    <input type="search" class="mui-input-clear" placeholder="搜索" style="color:#333333;font-size: 12px;">
				</div>
			</div>
			<div class="mui-content flexw">
			     <div data-id="water">
			     	<img src="images/s.svg" alt="" /> 水
			     </div>
			     <div data-id="electric">
			     	<img src="images/d.svg" alt="" />电
			     </div>
			     <div data-id="wood">
			     	<img src="images/m.svg" alt="" />木
			     </div>
			     <div data-id="tile">
			     	<img src="images/w.svg" alt="" />瓦
			     </div>
			     <div data-id="oil">
			     	<img src="images/y.svg" alt="" />油
			     </div>
			</div>
			<div style="text-align:center;padding:20px 10px 0">
				<img style="vertical-align:middle;margin:0 5px;width:25px" src="images/activity.svg"/>最新活动
			</div>
			<div class="mui-content flexws ltac">
			     <div id="">
			     	<div class="imgb" style="background-color:#7dc5eb"><img src="images/1.svg" alt="" /></div>快捷下单
			     </div>
			     <div class="gxb">
			     	<div class="imgb" style="background-color:#be8dbd"><img src="images/2.svg" alt="" /></div>工序包下单
			     </div>
			     <div id="">
			     	<div class="imgb" style="background-color:#7cba59"><img src="images/3.svg" alt="" /></div>拍照下单
			     </div>
			     <div id="">
			     	<div class="imgb" style="background-color:#ea986c"><img src="images/4.svg" alt="" /></div>我的收藏
			     </div>
			</div>
			<div class="mui-content flexw ltac">
			     <div id="">
			     	<div class="imgb" style="background-color:#e8989a"><img src="images/5.svg" alt="" /></div>物流
			     </div>
			     <div id="">
			     	<div class="imgb" style="background-color:#8992c8"><img src="images/6.svg" alt="" /></div>签到
			     </div>
			     <div id="">
			     	<div class="imgb" style="background-color:#199f97"><img src="images/7.svg" alt="" /></div>钱包
			     </div>
			     <div id="">
			     	<div class="imgb" style="background-color:#e15d4b"><img src="images/8.svg" alt="" /></div>咨询
			     </div>
			</div>
			
			<!--常购清单-->
			<div style="text-align:center;padding:20px 10px">
				常购清单
				<span style="float:right;font-size:12px">更多</span>
			</div>
			
			<!--商品列表-->
		    <div class="goodsList" id="goodsList"></div>
		    
		    <script type="text/html" id="goodsTpl">
		    	<ul class="mui-table-view">
		    		<%for(var i = 0 ;i<list.length;i++){%>
			    		<li style="width:50%!important;float:left;border:none" class="mui-table-view-cell mui-media" id="<%=list[i].id%>">
					        <a href="javascript:;">
					            <img class="mui-media-object" style="display:block!important;width:100%!important;max-width:none;height:auto" src="<%=list[i].coverImageUri%>">
					          	<br>
					            <div class="mui-media-body" style="font-size:12px">
					                <%=list[i].goodsName%>
					                <p class='mui-ellipsis'>规格:<%=list[i].goodsSpecification%> &nbsp;单位:<%=list[i].goodsUnit%></p>
						            <span>￥<%=list[i].memberPrice%></span>
									<img style="display:inline-block;float:right;margin-left:5px;vertical-align:middle;width:20px" src="images/addcart.svg"/>
						            
					            </div>
					        </a>
					    </li>
		    		<%}%> 
				</ul>
		    </script>
		
			<div style="text-align:center;padding:20px 10px">
				热门商品
				<span style="float:right;font-size:12px">更多</span>
			</div>
			<div style="clear: both;"></div>
			<!--商品列表-->
		    <div class="goodsList" id="goodsListHot"></div>
		    
		    <script type="text/html" id="goodsHotTpl">
		    	<ul class="mui-table-view" style="border-top: none!important;">
		    		<%for(var i = 0 ;i<list.length;i++){%>
			    		<li class="mui-table-view-cell mui-media" id="<%=list[i].id%>"  style="width:50%!important;float:left;border:none!important">
					        <a href="javascript:;" style="border-top: none!important;">
					            <img class="mui-media-object" style="display:block!important;width:100%!important;max-width:none;height:auto" src="<%=list[i].coverImageUri%>">
					          	<br>
					            <div class="mui-media-body" style="font-size:12px">
					                <%=list[i].goodsName%>
					                <p class='mui-ellipsis'>规格:<%=list[i].goodsSpecification%> &nbsp;单位:<%=list[i].goodsUnit%></p>
						            <span>￥<%=list[i].memberPrice%></span>
									<img style="display:inline-block;float:right;margin-left:5px;vertical-align:middle;width:20px" src="images/addcart.svg"/>
						            
					            </div>
					        </a>
					    </li>
		    		<%}%> 
				</ul>
		    </script>
		
		</div>
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/mui.min.js"></script>
		<script src="js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/app.js"></script>
		<!--<script src="js/default.js" type="text/javascript" charset="utf-8"></script>-->
		
		<script>
			//获得slider插件对象
			var gallery = mui('.mui-slider');
			gallery.slider({
			  interval:5000//自动轮播周期，若为0则不自动播放，默认为0；
			});
			
			$('.gxb').click(function(){
				mui.openWindow({
					url: 'page/gxb.html',
					id: 'gxb', 
					show: {
						aniShow: 'fade-in'
					},
					styles: {
						popGesture: 'hide'
					},
					waiting: {
						autoShow: false
					}, 
				});
			})
			var goodsCt = document.querySelectorAll('.flexw div');
			[].forEach.call(goodsCt,function(ele,i){
				ele.onclick = function(){ 
					mui.openWindow({
						url: 'page/goodlist.html',
						id: 'goodlist', 
						show: {
							aniShow: 'fade-in'
						},
						styles: {
							popGesture: 'hide'
						},
						waiting: {
							autoShow: false
						},
						 extras:{ctid:ele.getAttribute('data-id')}
					});
				}
			})
			 
				mui.init();
				var settings = app.getSettings();
				var account = document.getElementById('account');
				//
				window.addEventListener('show', function() {
					var state = app.getState();
					account.innerText = state.account;
				}, false); 
				mui.plusReady(function() {
					 
					if(plus.storage.getItem("$identityType")){
						var identityT = JSON.parse(plus.storage.getItem("$identityType")).identityType;
					}else{
						var identityT = 6;
					}
					//var userId = plus.storage.getItem('$userId'); 
					var userId = 49; 
					var settingPage = mui.preload({
						"id": 'setting',
						"url": 'setting.html'
					});
					//设置
					var settingButton = document.getElementById('setting');
					//settingButton.style.display = settings.autoLogin ? 'block' : 'none';
					settingButton.addEventListener('tap', function(event) {
						mui.openWindow({
							id: 'setting',
							show: {
								aniShow: 'pop-in'
							},
							styles: {
								popGesture: 'hide'
							},
							waiting: {
								autoShow: false
							}
						});
					});
				
					//常购商品列表
					mui.ajax('http://119.23.149.7:9999/app/goods/often/list',{
						data:{ 
							userId:'49',
							identityType:'6'
						},
						dataType:'json',
						headers: {"Authorization": plus.storage.getItem("oldToken")},
						type:'post',
						timeout:10000,
						success:function(data,type,xhr){ 
							console.log('常购商品列表',data);
							if(data.code == 0 ){
								plus.nativeUI.closeWaiting();
								if(data.content.length){
									$('#goodsList').html(template('goodsTpl',{list:data.content}));
								}else{
									$('#goodsList').html('<div style="text-align:center;padding:15px;font-size: 12px">暂无商品</div>') 
								}
							}else{
								mui.toast(data.message)
							}
							 
						},
						error:function(xhr,type,errorThrown){
							plus.nativeUI.closeWaiting();
							mui.toast(type)
							console.log('登录响应失败');
						}
					}); 
					//热门商品列表
					mui.ajax('http://119.23.149.7:9999/app/goods/hot/list',{
						data:{ 
							userId:userId,
							identityType:'6'
						},
						dataType:'json',
						headers: {"Authorization": plus.storage.getItem("oldToken")},
						type:'post',
						timeout:10000,
						success:function(data,type,xhr){ 
							console.log('热门商品列表'+JSON.stringify(data));
							if(data.code == 0 ){
								plus.nativeUI.closeWaiting();
								if(data.content.length){
									$('#goodsListHot').html(template('goodsHotTpl',{list:data.content}));
								}else{
									$('#goodsListHot').html('<div style="text-align:center;padding:15px;font-size: 12px;">暂无商品</div>') 
								}
							}else{
								mui.toast(data.message)
							}
							 
						},
						error:function(xhr,type,errorThrown){
							plus.nativeUI.closeWaiting();
							mui.toast(type)
							console.log('登录响应失败');
						}
					}); 
		}); 
		</script>
	</body>

</html>