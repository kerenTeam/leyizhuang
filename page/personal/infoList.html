<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>通知消息</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">  
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/commonY.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/configW.css"/>
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/artTemplate-native.js"></script>
		 
	</head>
	<style type="text/css">
		#userBox{
				background-color: #F53C42;
				padding: 0px 0;
			    position: relative;
			    overflow: hidden;
			    height: 3rem;
		}
		#mypic1{height: 100%;}
		#beijing2{position: absolute;z-index:1;width: 100%;height: 100%;top: 0;background-color: rgba(0, 0, 0, 0.5);} 
		 
		.userAvator{ 
			position: absolute;
			left: 50%;
			width: 1rem; 
			bottom: 1.2rem;
			height: 1rem; 
			-webkit-transform: translateX(-50%);
			z-index: 9;
			border-radius: 50%;
		}
		.idhiji,.personalSign{
			position: absolute;
			left: 50%; 
			bottom: 0.9rem; 
			-webkit-transform: translateX(-50%);
			z-index: 9;
			color: white; 
		}  
		.personalSign{bottom: 0.6rem; }
		.personalSign img{width: 20px;margin-left: 5px;}
		.newbop{bottom: 0.3rem;}
		.bottomop{border-bottom: 1px solid #f3f3f3;}
		.bottomop img{width:22px}
		.flexr{display:flex;width:100%;background-color:white;justify-content:space-between;color: #303030;align-items: center;}
		.flexa{display: flex;align-items: center;line-height: 1.5;} 
		.bottomop>div{padding:14px 0;display:flex;width:50%;justify-content:center;align-items:center;position:relative;}
		/*.bottomop div:first-child{border-right:1px solid #f3f3f3}*/ 
		.bottomop .active{color:#f31414}
		.bottomop div:after{position:absolute;bottom:0;left:50%;right:50%;height:2px;background-color:#f31414;content:""}
		.bottomop .active:after{left:25px!important;right:25px!important;transition:all .3s}
		/*#QA{padding-top: 52px;}*/
		.qashadow{margin-bottom: 10px;background-color: white;padding:10px 15px;}
		.qbot{margin-top: 10px;line-height: 1.3;}
		.Avator{width: 40px!important;height: 40px!important;border-radius: 50%;}
		.rsImg{margin-right:10px;border-radius:3px;overflow: hidden;flex-basis: -webkit-calc(100vw * 0.2);flex-basis: -moz-calc(100vw * 0.2);flex-basis: calc(100vw * 0.2);}
		.rsImg img{width: 100%;border-radius: 3px;}
		.listSon{position: absolute;left: -20px;top: 0;width: 100%;}
		.middleI{position: absolute;left: 0px !important;top: 0;opacity: 1; z-index: 1; transition-duration: .2s;transition-property:opacity left;transition-timing-function: ease-in-out;}
		.leftT{position: absolute;left: -20px !important;top: 0;opacity: 0; z-index: 10;}	
		.QA{display: none;}
		.qative{display: block;} 
		.mui-bar-nav{box-shadow: none !important;}
		#upload{height: 30px;min-height: 30px;padding-top: 0;}
		.answerImf{padding: 0 15px;}
		.answerImf .anImg{width:calc((100vw - 50px) / 4);height:calc((100vw - 50px) / 4);border-radius:3px;display: inline-block;}
		.adge{display: block;width: 20px;height:20px;background-color: #f31414;color: white;text-align: center;line-height: 1.6;border-radius: 50%;}
	</style>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize" style="margin-left: 0;"></a>
		    <h1 class="mui-title">通知消息</h1>  
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏-->
	 
		<!--状态栏结束-->
		<div class="mui-content">
			 
			<div id="QA"><!--大盒子-->
				<div class="QA qative dyCon" id="questions" style="display: block;">
					 
				</div><!--盒子一-->
				
				<script type="text/html" id="listinfo">
					<%for(var i=0;i<list.length;i++){%>
						<div class="qashadow" onclick="">
							<div class="qtop flexr">
								<div class="ft14 activecl">
								系统通知
								</div>
								<div class="">
									<span class="disablecl ft12"><%= list[i].createTime%></span>
								</div>
							</div>
							<div class="qbot ft14">
								<%=list[i].title%>
							</div>
						</div>
					<%}%>	
				</script>	
			</div><!--大盒子-->
			
		</div>
	 </body>
	 <script src="../../js/default.js" type="text/javascript" charset="utf-8"></script>
	 <script type="text/javascript">
	 	//动态详情
		function DTdetail(id,userid){
			event.stopPropagation();
			openview({
				view:'../socialCircle/mycircleIndex.html',
				extrasobj: {
					infoid: id,
					UserId:userid,
					delc:1,
				}
			})
		}
	 </script>
	<script type="text/javascript">
		shopData();
		function shopData(){
			mui.plusReady(function(){
				var identityT = JSON.parse(plus.storage.getItem("$identityType")).identityType;
				var userId = plus.storage.getItem('$userId'); 
				var oldToken = plus.storage.getItem('oldToken');
				plus.nativeUI.showWaiting();//显示等待框
					mui.ajax(serverUrl+'/app/user/message/list',{
						data:{
							userId:userId,
							identityType:identityT
						},
						dataType:'json',
						type:'post',
						timeout:10000,
						headers:{"Authorization":oldToken},
						success:function(data,type,xhr){
							plus.nativeUI.closeWaiting();
							console.log('消息',data);
					       	if(data.code == 0){
						       	if(data.content && data.content.length){
						       		for(var i in data.content){
//						       			var dt = new Date(nowArray[j].create_time).getTime(); 
										var dt = data.content[i].createTime;
										data.content[i].createTime = getDateDiff(dt);
						       		}
					     			var html = template("listinfo",{list:data.content});
									document.getElementById("questions").innerHTML=html;
								}else{
									document.getElementById("questions").innerHTML='<div style="text-align: center;padding: 50px;">暂无通知消息</div>'
								}
					       	}
					       	plus.nativeUI.closeWaiting();
						},
						error:function(xhr,type,errorThrown){
							plus.nativeUI.closeWaiting();
							console.log('当前网络不好,请重试');
						}
					});
			})
		}
		
		//发布时间判断 
		var minute = 1000 * 60;
		var hour = minute * 60;
		var day = hour * 24;
		var halfamonth = day * 15;
		var month = day * 30;
		function getDateDiff(dateTimeStamp){ 
			var now = new Date().getTime(); 
			var diffValue = now - dateTimeStamp; 
			var monthC =diffValue/month;
			var weekC =diffValue/(7*day);
			var dayC =diffValue/day;
			var hourC =diffValue/hour;
			var minC =diffValue/minute;
			if(monthC>=1){
			 result=parseInt(monthC) + "月前";
			 }
			 else if(weekC>=1){
			 result=parseInt(weekC) + "周前";
			 }
			 else if(dayC>=1){
			 result=parseInt(dayC) +"天前";
			 }
			 else if(hourC>=1){
			 result=parseInt(hourC) +"小时前";
			 }
			 else if(minC>=1){
			 result=parseInt(minC) +"分钟前";
			 }else{ 
			 result="刚刚";
			 }
			return result;
		}
	</script>


</html>