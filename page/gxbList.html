<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../css/style.css" />
	</head>
	<style type="text/css"> 
		.gxbList{padding:20px;width: calc((100vw - 50px) / 2);float: left;text-align: center;background-color: #FF5053;margin: 5px;}
	</style>
	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title" id='gName'></h1>
		</header>
		<div class="mui-content">
		
			<!--小分类-->
			<div style="background-color:white;padding:15px;font-size:14px">
		     	<div class="categray">
		     		<span class="mui-badge mui-badge-danger">全部</span><div class="categraya"></div>
		     		 
		     	</div>
		     	<div class="categray">
		     		<span class="mui-badge mui-badge-danger">品牌</span><div class="categrayb"></div>
		     	</div>
		     	<div class="categray">
		     		<span class="mui-badge mui-badge-danger">规格</span><div class="categrayc"></div>
		     	</div>
		     	<div class="categray">
		     		<span class="mui-badge mui-badge-danger">类型</span><div class="categrayd"></div>
		     	</div>
		    </div>
		  
		    <!--商品列表-->
		    <div class="goodsList" id="goodsList"></div>
		    
		    <script type="text/html" id="goodsTpl">
		    	<ul class="mui-table-view">
		    		<%for(var i = 0 ;i<list.length;i++){%>
			    		<li class="mui-table-view-cell mui-media" id="<%=list[i].id%>">
					        <a href="javascript:;">
					            <img class="mui-media-object mui-pull-left" src="<%=list[i].coverImageUri%>">
					            <div class="mui-media-body">
					                <%=list[i].goodsName%>
					                <p class='mui-ellipsis'>规格:<%=list[i].goodsSpecification%> &nbsp;单位:<%=list[i].goodsUnit%></p>
						            <span>￥<%=list[i].memberPrice%></span>
									<img style="display:inline-block;float:right;margin-left:5px;vertical-align:middle" src="../images/addcart.svg"/>
						            <div style="display:inline-block;float:right;" class="mui-numbox" data-numbox-step='1' data-numbox-min='0' data-numbox-max='100'>
									  <button class="mui-btn mui-numbox-btn-minus" type="button">-</button>
									  <input class="mui-numbox-input" type="number" />
									  <button class="mui-btn mui-numbox-btn-plus" type="button">+</button>
									</div>
					            </div>
					        </a>
					    </li>
		    		<%}%>  
				</ul>
		    </script>  
		</div>
		<script src="../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/mui.min.js"></script>
		<script src="../js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/default.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			mui.init();
			mui.plusReady(function(){
//				var identityT = JSON.parse(plus.storage.getItem("$identityType")).identityType;
				var identityT = '6';
				//var userId = plus.storage.getItem('$userId'); 
				var userId = 49;
				var gxId = plus.webview.currentWebview().gid;//商品列表
				var gName = plus.webview.currentWebview().gname;
				$('#gName').html(gName)
				plus.nativeUI.showWaiting();
				mui.ajax('http://119.23.149.7:9999/app/process/processGoods/list',{
					data:{
						userId:userId,identityType:identityT,processId:gxId
					},
					dataType:'json',
					headers: {"Authorization": plus.storage.getItem("oldToken")},
					type:'post',
					timeout:10000,
					success:function(data,type,xhr){ 
						console.log('工序包列表'+JSON.stringify(data));
						if(data.code == 0 ){
							plus.nativeUI.closeWaiting();
							if(data.content.length){
								$('#goodsList').html(template('goodsTpl',{list:data.content}));
							}else{
								$('#goodsList').html('<div style="text-align:center;padding:15px">暂无工序包列表</div>') 
							}
						}else{
							mui.toast(data.message)
						}
						 
					},
					error:function(xhr,type,errorThrown){
						plus.nativeUI.closeWaiting();
						mui.toast(type)
						console.log('登录响应失败');
					}
				}); 
			})
			
			function goInfo(id){
				mui.openWindow({
					url: 'gxblist.html',
					id: 'gxblist', 
					show: {
						aniShow: 'fade-in'
					},
					styles: {
						popGesture: 'hide'
					},
					waiting: {
						autoShow: false
					},
					 extras:{gid:id}
				});
			}
		</script>
	</body>

</html>