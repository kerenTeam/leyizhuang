<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>个人中心</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="css/mui.min.css" />
		<link rel="stylesheet" type="text/css" href="css/center.css"/>
		<style type="text/css">
			body {
				margin: 0;
			}
			
			body::-webkit-scrollbar {
				/*滚动条*/
				width: 0!important;
				height: 0!important;
				opacity: 1!important;
			}
			.white {
				color: #FFFFFF !important;
				width: 100%;
			}
			
			.myInfo {
				width: 85px;
				height: 85px;
				margin: 0 6%;
				border-radius: 50%;
				border: 2px solid #fff;
			}
			
			.denlu {
				font-size: 17px;
			}
			
			/*修改*/
			.denlu {
				padding-left: 20px;
				color: #fff;
				line-height: 25px;
			}
			.writing {
				padding: 5px 0;
				padding-bottom: 5px;
			}
			#userBox {
				background-color: #eca4a6;
				padding: 35px 0 12px;
				position: relative;
			}
			.dao {
				color: white!important;
				border-color: white;
				padding: 1px 7px;
				top: 10px;
				right: 10px;
				position: absolute;
				font-size: 12px;
				border-radius: 2px;
			}
		
			.centop span {
				display: inline-block;
				padding: 4px 0;
				font-size: 14px;
			}
			
			#beijing {
				position: absolute;
				z-index: 10;
				width: 100%;
				height: 100%;
				top: 0;
				overflow: hidden;
				-webkit-filter: blur(5px);
			}
			
			#beijing img {
				width: 100%;
				position: relative;
				top: -40%;
			}
			
			#beijing2 {
				position: absolute;
				z-index: 20;
				width: 100%;
				height: 100%;
				top: 0;
				background-color: rgba(241, 63, 63, 0.76);
			}
			
			#userBox .content {
				position: relative;
				z-index: 30;
			}
			
			#numjifen {
				z-index: 99;
				font-weight: 500;
				padding: 0;
				line-height: 20px;
				font-size: 14px;
			}
			
			body {
				background-color: #f8f8f8 !important;
				width: 100%;
				overflow-x: hidden;
			}
			#fixdtop {
				position: fixed;
				top: 0;
				height: 25px;
				width: 100%;
				z-index: 100;
			}
		</style>

	</head>

	<body>
		<div class="clearfloat box-s box-ss" id="userBox">
			<!--src="img/morentouxiang.jpg"/-->
			<div id="beijing"><img id="mypic1" src="https://b-ssl.duitang.com/uploads/item/201710/12/20171012232816_GX5iw.thumb.224_0.jpeg"></div>
			<div id="beijing2"></div>
			<div id="fixdtop"></div>
			<div class="content clearfloat fl mui-row white">
				<div class="mui-col-sm-4 mui-col-xs-4" style="padding-top: 18px;position: relative;left: 3px;"><img src="https://b-ssl.duitang.com/uploads/item/201710/12/20171012232816_GX5iw.thumb.224_0.jpeg" class="myInfo" id="mypic" /></div>
				<div class="mui-col-sm-8 mui-col-xs-8 writing">
					<p class="centop">
						<span class="denlu denluzhuce" id="userName" style="z-index: 99;"></span> <br />
						<span class="denlu denluzhuce" style="display: inline-block;min-height: 20px;" id="coin">乐币:<span></span> 账户:<span id="accoutoney"></span><br />导购:<span id="guideName"></span><br />灯号:<span id="dengh"></span></span>
					</p>
				</div>
				<img class="dao shezhi" style="top: 8px;width: 35px;" src="images/center/shizhi.png" />
			</div>
		</div>
		<div id="customar">
			<div class="orderType flexRow">
				<div class="">
					待付款
				</div>
				<div class="">
					待收货
				</div>
				<div class="">
					待评价
				</div>
				<div class="">
					退货
				</div>
				<div class="">
					所有订单
				</div>
			</div>
			<div class="centerList">
				<div class="flexRow flexRow2">
					<div class="" onclick="goCollect()">
						商品收藏
					</div>
					<div class="">
						客服
					</div>
					<div class="">
						调色板
					</div>
					<div class="" onclick="goMessage()">
						消息
					</div>
					
				</div>
				<div class="flexRow flexRow2">
					<div class="">
						设置
					</div> 
					<div class="">
						优惠券
					</div>
					<div class="">
						产品券
					</div>
					<div class="">
						我的钱包
					</div>
				</div>
				<div  class="flexRow flexRow2">
					<div class="">
						我的乐豆
					</div>
					<div >
						拍照下单
					</div>
					<div style="visibility: hidden;">
						ccc
					</div>
					<div style="visibility: hidden;">
						ccc
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript">
			window.onscroll = function() {
				if(document.body.scrollTop > 25) {
					document.getElementById('fixdtop').style.backgroundColor = '#af4444';
				} else {
					document.getElementById('fixdtop').style.background = 'none';
				}
			}
		</script>
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/app.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			//分类订单
			function typeOrder(type) {
				openview({
					view: 'personal/sc-order.html',
					id: 'sc-order',
					extrasobj: {
						status: type
					}
				});
			}
			//收藏
			function goCollect(){
				openview({
					view:'page/collect.html',
					id: 'collect', 
				}) 
			}
			function goMessage(){
				openview({
					view:'page/message.html',
					id: 'message', 
				}) 
			}
			mui.plusReady(function() {
				Refresh();

				function Refresh() { //刷新
					//获取缓存 
					//					var identityT = JSON.parse(plus.storage.getItem("$identityType")).identityType;
					var identityT = '6';
					//var userId = plus.storage.getItem('$userId'); 
					var userId = 49;
					var oldToken = plus.storage.getItem('oldToken');
					loadmyinfo();

					function loadmyinfo() {
						//个人信息
						mui.ajax('http://119.23.149.7:9999/app/user/homepage', {
							data: {
								userId: userId,
								identityType: identityT
							},
							dataType: 'json',
							headers: {
								"Authorization": oldToken
							},
							type: 'post',
							timeout: 10000,
							success: function(data, type, xhr) {
								console.log('个人信息', data);
								if(data.code == 0) {
									plus.nativeUI.closeWaiting();
									if(data.content) {
										if(data.content.name) {
											$('#userName').html(data.content.name)
										} else {
											$('#userName').html('匿名')

										}
										if(data.content.picUrl) {
											$('#mypic').attr('src', data.content.picUrl)
										}
										if(data.content.picUrl) {
											$('#mypic').attr('src', data.content.picUrl)
										}
										if(data.content.guideName) {
											$('#guideName').html(data.content.guideName)
										} else {
											$('#guideName').html('无')
										}
										if(data.content.guideMobile) {
											$('#guideMobile').attr('href', 'tel:' + data.content.guideMobile)
										}
										if(data.content.number) {
											$('#dengh').html(data.content.number)
										} else {
											$('#dengh').html('无')
										}
									}
								} else {
									mui.toast(data.message)
								}

							},
							error: function(xhr, type, errorThrown) {
								plus.nativeUI.closeWaiting();
								mui.toast(type)
								console.log('登录响应失败');
							}
						});
						//乐币
						mui.ajax('http://119.23.149.7:9999/app/customer/lebi/balance', {
							data: {
								userId: userId,
								identityType: identityT
							},
							dataType: 'json',
							headers: {
								"Authorization": oldToken
							},
							type: 'post',
							timeout: 10000,
							success: function(data, type, xhr) {
								console.log('个人信息', data);
								if(data.code == 0) {
									plus.nativeUI.closeWaiting();
									if(data.content) {}
								} else {
									mui.toast(data.message)
								}

							},
							error: function(xhr, type, errorThrown) {
								plus.nativeUI.closeWaiting();
								mui.toast(type)
								console.log('登录响应失败');
							}
						});

					}
				} //刷新	
			});
		</script>

	</body>

</html>